

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flux Definition &mdash; SkyLLH  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Parameter Definition" href="parameters.html" />
    <link rel="prev" title="Source Definition" href="source_definition.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SkyLLH
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Concepts</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataset.html">Dataset Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="datafields.html">Loading data fields from data files</a></li>
<li class="toctree-l2"><a class="reference internal" href="source_definition.html">Source Definition</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Flux Definition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#General-Flux-Function">General Flux Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Units-for-flux-models">Units for flux models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Factorized-Flux-Function">Factorized Flux Function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Steady-Point-Like-Flux">Steady Point-Like Flux</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Evaluating-the-flux-model-function">Evaluating the flux model function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameters.html">Parameter Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdf.html">PDFs</a></li>
<li class="toctree-l2"><a class="reference internal" href="detsigyield.html">Detector Signal Yield</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">Frequently Ask Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/skyllh.html">skyllh package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes.html">Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_docs/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_docs/unit_tests.html">Unit tests</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SkyLLH</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Concepts</a></li>
      <li class="breadcrumb-item active">Flux Definition</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/concepts/flux_definition.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">astropy</span><span class="w"> </span><span class="kn">import</span> <span class="n">units</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
<section id="Flux-Definition">
<h1>Flux Definition<a class="headerlink" href="#Flux-Definition" title="Link to this heading"></a></h1>
<p>SkyLLH provides a sophisticated class collection to describe a differential particle flux function.</p>
<section id="General-Flux-Function">
<h2>General Flux Function<a class="headerlink" href="#General-Flux-Function" title="Link to this heading"></a></h2>
<p>The most general differential flux function is:</p>
<p><span class="math notranslate nohighlight">\(\frac{\mathrm{d}^4\Phi(\alpha,\delta,E,t | \vec{p}_\mathrm{s})}{\mathrm{d}A \mathrm{d}\Omega \mathrm{d}E \mathrm{d}t}\)</span>,</p>
<p>which is a function of celestial coordinates right-ascention, <span class="math notranslate nohighlight">\(\alpha\)</span>, and declination, <span class="math notranslate nohighlight">\(\delta\)</span>, energy <span class="math notranslate nohighlight">\(E\)</span>, and time <span class="math notranslate nohighlight">\(t\)</span>, given source parameters <span class="math notranslate nohighlight">\(\vec{p}_\mathrm{s}\)</span>, e.g. source location and spectral index <span class="math notranslate nohighlight">\(\gamma\)</span> for a power-law energy profile.</p>
<p>The abstract base class for all flux function models is
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.FluxModel" title="skyllh.core.flux_model.FluxModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FluxModel</span></code></a>, which is derived from
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.math.MathFunction" title="skyllh.core.math.MathFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">MathFunction</span></code></a> and
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.model.Model" title="skyllh.core.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>.</p>
<p>The <a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.FluxModel" title="skyllh.core.flux_model.FluxModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FluxModel</span></code></a> has the abstract
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.FluxModel.__call__" title="skyllh.core.flux_model.FluxModel.__call__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code></a> method defined, which will
evaluate the flux function for values of <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\delta\)</span>,
<span class="math notranslate nohighlight">\(E\)</span>, and <span class="math notranslate nohighlight">\(t\)</span> given in specific units.</p>
</section>
<section id="Units-for-flux-models">
<h2>Units for flux models<a class="headerlink" href="#Units-for-flux-models" title="Link to this heading"></a></h2>
<p>The <a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.FluxModel" title="skyllh.core.flux_model.FluxModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FluxModel</span></code></a> class defines the units used
for length, angle, energy, and time. The default units are configured through
a <a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.config.Config" title="skyllh.core.config.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">skyllh.core.config.Config</span></code></a> instance, in particular through the
<code class="docutils literal notranslate"><span class="pre">cfg['units']['defaults']['fluxes']</span></code> dictionary of the
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.config.Config" title="skyllh.core.config.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a> instance. Units must be derived classes
from the <code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.units.UnitBase</span></code> class.</p>
<p>The <a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.FluxModel" title="skyllh.core.flux_model.FluxModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FluxModel</span></code></a> class has the properties
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.FluxModel.unit_str" title="skyllh.core.flux_model.FluxModel.unit_str"><code class="xref py py-attr docutils literal notranslate"><span class="pre">unit_str</span></code></a> and
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.FluxModel.unit_latex_str" title="skyllh.core.flux_model.FluxModel.unit_latex_str"><code class="xref py py-attr docutils literal notranslate"><span class="pre">unit_latex_str</span></code></a> for a representation
of the units as a <code class="docutils literal notranslate"><span class="pre">str</span></code> object in plain text and latex code.</p>
</section>
<section id="Factorized-Flux-Function">
<h2>Factorized Flux Function<a class="headerlink" href="#Factorized-Flux-Function" title="Link to this heading"></a></h2>
<p>Usually the flux function can be split into a spatial, energy, and time profile
with an overall normalization constant in differential flux unit, i.e.
<span class="math notranslate nohighlight">\(\mathrm{area}^{-1} \mathrm{solid-angle}^{-1} \mathrm{energy}^{-1} \mathrm{time}^{-1}\)</span>.
Hence, SkyLLH provides the class
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.FactorizedFluxModel" title="skyllh.core.flux_model.FactorizedFluxModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorizedFluxModel</span></code></a>, which describes a
differential flux function as the product of individual flux profiles:</p>
<div class="math notranslate nohighlight">
\[\Phi(\alpha,\delta,E,t | \vec{p}_\mathrm{s}) =
        \Phi_0
        \Psi(\alpha,\delta|\vec{p}_\mathrm{s})
        \epsilon(E|\vec{p}_\mathrm{s})
        T(t|\vec{p}_\mathrm{s})\]</div>
<p>The abstract base class for any flux profile is
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.FluxProfile" title="skyllh.core.flux_model.FluxProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">FluxProfile</span></code></a>, which is derived from
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.math.MathFunction" title="skyllh.core.math.MathFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">MathFunction</span></code></a>.</p>
<p>The abstract base class for a spatial, energy, and time flux profile is
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.SpatialFluxProfile" title="skyllh.core.flux_model.SpatialFluxProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialFluxProfile</span></code></a>,
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.EnergyFluxProfile" title="skyllh.core.flux_model.EnergyFluxProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyFluxProfile</span></code></a>, and
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.TimeFluxProfile" title="skyllh.core.flux_model.TimeFluxProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeFluxProfile</span></code></a>, respectively, and are
derived from <a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.FluxProfile" title="skyllh.core.flux_model.FluxProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">FluxProfile</span></code></a>.</p>
<section id="Steady-Point-Like-Flux">
<h3>Steady Point-Like Flux<a class="headerlink" href="#Steady-Point-Like-Flux" title="Link to this heading"></a></h3>
<p>A very common source hypothesis is a steadily emitting point-like source. Hence,
SkyLLH provides the class
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.SteadyPointlikeFFM" title="skyllh.core.flux_model.SteadyPointlikeFFM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SteadyPointlikeFFM</span></code></a>. It takes a flux
normalization <span class="math notranslate nohighlight">\(\Phi_0\)</span>, and an energy profile as constructor arguments.
As spatial profile it uses the
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.PointSpatialFluxProfile" title="skyllh.core.flux_model.PointSpatialFluxProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">PointSpatialFluxProfile</span></code></a> class.</p>
<p>As an example we create a steady point-like factorized flux model with a
power-law energy flux profile.</p>
<p>But first we need to create a configuration:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">skyllh.core.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">Config</span>
<span class="n">cfg</span><span class="o">=</span><span class="n">Config</span><span class="p">()</span>
</pre></div>
</div>
</div>
Now we see what the default units are:<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">skyllh.core.flux_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">FluxModel</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">FluxModel</span><span class="o">.</span><span class="n">get_default_units</span><span class="p">(</span><span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;angle&#39;: Unit(&#34;rad&#34;), &#39;energy&#39;: Unit(&#34;GeV&#34;), &#39;length&#39;: Unit(&#34;cm&#34;), &#39;time&#39;: Unit(&#34;s&#34;)}
</pre></div></div>
</div>
Now we need to create the energy flux profile. As reference energy and spectral
index we choose $E_0=10^3$~GeV and $\gamma=2$, respectively:<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">skyllh.core.flux_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">PowerLawEnergyFluxProfile</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">energy_profile</span> <span class="o">=</span> <span class="n">PowerLawEnergyFluxProfile</span><span class="p">(</span>
    <span class="n">E0</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span>
    <span class="n">gamma</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">energy_unit</span><span class="o">=</span><span class="n">units</span><span class="o">.</span><span class="n">GeV</span><span class="p">,</span>
    <span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">energy_profile</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(E / (1000 GeV))^-2
</pre></div></div>
</div>
<p>The next step is to create the
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.SteadyPointlikeFFM" title="skyllh.core.flux_model.SteadyPointlikeFFM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SteadyPointlikeFFM</span></code></a> class instance. As
normalization constant we choose
<span class="math notranslate nohighlight">\(\Phi_0 = 10^{-8} \text{GeV}^{-1}\text{cm}^{-2}\text{sr}^{-1}\text{s}^{-1}\)</span>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">skyllh.core.flux_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">SteadyPointlikeFFM</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fluxmodel</span> <span class="o">=</span> <span class="n">SteadyPointlikeFFM</span><span class="p">(</span>
    <span class="n">Phi0</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span>
    <span class="n">energy_profile</span><span class="o">=</span><span class="n">energy_profile</span><span class="p">,</span>
    <span class="n">angle_unit</span><span class="o">=</span><span class="n">units</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span>
    <span class="n">time_unit</span><span class="o">=</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
    <span class="n">length_unit</span><span class="o">=</span><span class="n">units</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span>
    <span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fluxmodel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.000e-08 * (E / (1000 GeV))^-2 * 1 (GeV cm^2 s)^-1
</pre></div></div>
</div>
</section>
</section>
<section id="Evaluating-the-flux-model-function">
<h2>Evaluating the flux model function<a class="headerlink" href="#Evaluating-the-flux-model-function" title="Link to this heading"></a></h2>
<p>The flux model function can be evaluated by calling its
<a class="reference internal" href="../reference/skyllh.core.html#skyllh.core.flux_model.FluxModel.__call__" title="skyllh.core.flux_model.FluxModel.__call__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code></a> operator:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flux</span> <span class="o">=</span> <span class="n">fluxmodel</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="mf">3e3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;flux.shape = </span><span class="si">{</span><span class="n">flux</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;flux = </span><span class="si">{</span><span class="n">flux</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
flux.shape = (1, 1, 1)
flux = [[[1.11111111e-09]]]
</pre></div></div>
</div>
It returns a 3-dimensional numpy array, where the first, second, and third
dimension represents the spatial, energy, and time axes, respectively. Hence,
we can evaluate the flux model for different spatial coordinates, energies, and
times by a single call:<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flux</span> <span class="o">=</span> <span class="n">fluxmodel</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="p">[</span><span class="mf">3e3</span><span class="p">,</span> <span class="mf">2e2</span><span class="p">],</span> <span class="n">t</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;flux.shape = </span><span class="si">{</span><span class="n">flux</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;flux = </span><span class="si">{</span><span class="n">flux</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
flux.shape = (1, 2, 3)
flux = [[[1.11111111e-09 1.11111111e-09 1.11111111e-09]
  [2.50000000e-07 2.50000000e-07 2.50000000e-07]]]
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="source_definition.html" class="btn btn-neutral float-left" title="Source Definition" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="parameters.html" class="btn btn-neutral float-right" title="Parameter Definition" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, The IceCube Collaboration, T. Kontrimas, M. Wolf.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v23.2.1.rc1
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="../../../master/html/index.html">master</a></dd>
      <dd><a href="../../../coords/html/index.html">coords</a></dd>
      <dd><a href="../../../data_release/html/index.html">data_release</a></dd>
      <dd><a href="../../../dm/html/index.html">dm</a></dd>
      <dd><a href="../../../fix169_fix203/html/index.html">fix169_fix203</a></dd>
      <dd><a href="../../../fix230/html/index.html">fix230</a></dd>
      <dd><a href="../../../llh_module/html/index.html">llh_module</a></dd>
      <dd><a href="../../../signal_gen_method/html/index.html">signal_gen_method</a></dd>
      <dd><a href="../../../stack_public/html/index.html">stack_public</a></dd>
    </dl>
    <dl>
      <dt>Tags</dt>
      <dd><a href="../../../v19_09_15/html/index.html">v19_09_15</a></dd>
      <dd><a href="../../../v20_01_09/html/index.html">v20_01_09</a></dd>
      <dd><a href="../../../v20_03_12/html/index.html">v20_03_12</a></dd>
      <dd><a href="../../../v20_11_02/html/index.html">v20_11_02</a></dd>
      <dd><a href="../../../v21_10_18_temp/html/index.html">v21_10_18_temp</a></dd>
      <dd><a href="../../../v21_10_20/html/index.html">v21_10_20</a></dd>
      <dd><a href="../../../v22_04_28/html/index.html">v22_04_28</a></dd>
      <dd><a href="../../../v22_04_28a/html/index.html">v22_04_28a</a></dd>
      <dd><a href="../../../v23.0.0/html/index.html">v23.0.0</a></dd>
      <dd><a href="../../../v23.1.0/html/index.html">v23.1.0</a></dd>
      <dd><a href="../../../v23.1.1/html/index.html">v23.1.1</a></dd>
      <dd><a href="../../../v23.2.0/html/index.html">v23.2.0</a></dd>
      <dd><a href="../../../v23.2.1/html/index.html">v23.2.1</a></dd>
      <dd><a href="flux_definition.html">v23.2.1.rc1</a></dd>
      <dd><a href="../../../v24.1.0/html/index.html">v24.1.0</a></dd>
      <dd><a href="../../../v24.1.1a/html/index.html">v24.1.1a</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>